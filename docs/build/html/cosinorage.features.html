<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="cosinorage.bioages Module" href="cosinorage.bioages.html" /><link rel="prev" title="cosinorage.datahandlers Module" href="cosinorage.datahandlers.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>cosinorage.features Module - CosinorAge 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">CosinorAge 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">CosinorAge 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="cosinorage.html">Source Code Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Source Code Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cosinorage.datahandlers.html">cosinorage.datahandlers Module</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">cosinorage.features Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosinorage.bioages.html">cosinorage.bioages Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theoretical_background.html">Detailed References and Descriptions of Package Functionality</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/cosinorage.features.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="cosinorage-features-module">
<h1>cosinorage.features Module<a class="headerlink" href="#cosinorage-features-module" title="Link to this heading">¶</a></h1>
<section id="module-cosinorage.features">
<span id="module-contents"></span><h2>Module Contents<a class="headerlink" href="#module-cosinorage.features" title="Link to this heading">¶</a></h2>
<p>This module provides the functionality to compute a wide range
wearable-features based on minute-level ENMO data including
- Circadian rhythm features, e.g., IV, IS, RA, M10, L5
- Physical activity features, e.g., SB, LIPA, MVPA
- Sleep features, e.g., TST, WASO, SE, SR</p>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WearableFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/features.html#WearableFeatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.features.WearableFeatures" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for computing and managing features from wearable accelerometer data.</p>
<p>This class processes raw ENMO (Euclidean Norm Minus One) data to compute various
circadian rhythm and physical activity metrics, including cosinor analysis,
non-parametric measures, activity levels, and sleep metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handler</strong> (<a class="reference internal" href="cosinorage.datahandlers.html#cosinorage.datahandlers.datahandler.DataHandler" title="cosinorage.datahandlers.datahandler.DataHandler"><em>DataHandler</em></a>)</p></li>
<li><p><strong>features_args</strong> (<em>dict</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures.enmo">
<span class="sig-name descname"><span class="pre">enmo</span></span><a class="headerlink" href="#cosinorage.features.features.WearableFeatures.enmo" title="Link to this definition">¶</a></dt>
<dd><p>Raw ENMO data with datetime index</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures.feature_dict">
<span class="sig-name descname"><span class="pre">feature_dict</span></span><a class="headerlink" href="#cosinorage.features.features.WearableFeatures.feature_dict" title="Link to this definition">¶</a></dt>
<dd><p>Additional feature storage (if needed)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/features.html#WearableFeatures.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.features.WearableFeatures.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize WearableFeatures with data from a DataHandler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handler</strong> (<a class="reference internal" href="cosinorage.datahandlers.html#cosinorage.datahandlers.datahandler.DataHandler" title="cosinorage.datahandlers.datahandler.DataHandler"><em>DataHandler</em></a>) – DataHandler instance containing ENMO data</p></li>
<li><p><strong>features_args</strong> (<em>dict</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures.get_features">
<span class="sig-name descname"><span class="pre">get_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/features.html#WearableFeatures.get_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.features.WearableFeatures.get_features" title="Link to this definition">¶</a></dt>
<dd><p>Returns the entire feature DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame containing all computed features</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosinorage.features.features.WearableFeatures.get_ml_data">
<span class="sig-name descname"><span class="pre">get_ml_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/features.html#WearableFeatures.get_ml_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.features.WearableFeatures.get_ml_data" title="Link to this definition">¶</a></dt>
<dd><p>Returns the raw ENMO data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame containing ENMO data with datetime index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h2>
<section id="cosinor-circadian-rhythm-analysis-analysis">
<h3>Cosinor (Circadian Rhythm Analysis) Analysis<a class="headerlink" href="#cosinor-circadian-rhythm-analysis-analysis" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.cosinor_analysis.cosinor_multiday">
<span class="sig-name descname"><span class="pre">cosinor_multiday</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/cosinor_analysis.html#cosinor_multiday"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.cosinor_analysis.cosinor_multiday" title="Link to this definition">¶</a></dt>
<dd><p>A parametric approach to study circadian rhythmicity assuming cosinor shape, fitting a model for multiple days.</p>
<section id="parameters">
<h4>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame with a Timestamp index and a column ‘ENMO’ containing minute-level activity data.</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>dict: Dictionary containing cosinor parameters:</dt><dd><ul>
<li><p>MESOR: Midline Estimating Statistic Of Rhythm (rhythm-adjusted mean)</p></li>
<li><p>amplitude: Half the difference between maximum and minimum values</p></li>
<li><p>acrophase: Time of peak relative to midnight in radians</p></li>
<li><p>acrophase_time: Time of peak in hours (0-24)</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>pandas.Series: Fitted values for each timepoint</p></li>
</ul>
</dd>
</dl>
</section>
<section id="raises">
<h4>Raises:<a class="headerlink" href="#raises" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ValueError:</dt><dd><p>If DataFrame doesn’t have required ‘ENMO’ column or timestamp index
If data length is not a multiple of 1440 (minutes in a day)</p>
</dd>
</dl>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>DataFrame</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.cosinor_analysis.cosinor_model">
<span class="sig-name descname"><span class="pre">cosinor_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/cosinor_analysis.html#cosinor_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.cosinor_analysis.cosinor_model" title="Link to this definition">¶</a></dt>
<dd><p>Cosinor model function with counterclockwise acrophase.</p>
<p>This function implements the standard cosinor model for fitting periodic data.
The model assumes a cosine function with adjustable amplitude, phase, and period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array-like</em>) – Time points at which to evaluate the model.</p></li>
<li><p><strong>M</strong> (<em>float</em>) – MESOR (Midline Statistic of Rhythm) - the rhythm-adjusted mean.</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Amplitude - half the peak-to-trough difference (always positive).</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – Acrophase in radians (counterclockwise orientation).</p></li>
<li><p><strong>tau</strong> (<em>float</em>) – Period of the rhythm in the same units as t.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitted values at the specified time points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The model uses counterclockwise acrophase orientation (negative sign before phi)</p></li>
<li><p>The function implements: M + A * cos(2π * t / τ + φ)</p></li>
<li><p>Amplitude A should always be positive</p></li>
<li><p>The acrophase φ represents the time of peak activity</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create time points (24 hours in minutes)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1440</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 0 to 1440 minutes</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define cosinor parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="mf">0.5</span>    <span class="c1"># MESOR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="mf">0.3</span>    <span class="c1"># Amplitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Acrophase (peak at midnight)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mi">1440</span> <span class="c1"># Period (24 hours in minutes)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate fitted values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted</span> <span class="o">=</span> <span class="n">cosinor_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak value: </span><span class="si">{</span><span class="n">fitted</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trough value: </span><span class="si">{</span><span class="n">fitted</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.cosinor_analysis.fit_cosinor">
<span class="sig-name descname"><span class="pre">fit_cosinor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/cosinor_analysis.html#fit_cosinor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.cosinor_analysis.fit_cosinor" title="Link to this definition">¶</a></dt>
<dd><p>Fit cosinor model to time series data.</p>
<p>This function fits a cosinor model to time series data using the CosinorPy library.
It estimates the MESOR, amplitude, and acrophase parameters that best describe
the periodic pattern in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>array-like</em>) – Time points corresponding to the data values.</p></li>
<li><p><strong>data</strong> (<em>array-like</em>) – Observed values to fit the cosinor model to.</p></li>
<li><p><strong>period</strong> (<em>float</em><em>, </em><em>default=24</em>) – Known period of the rhythm in the same units as time.
For circadian rhythms, typically 24 hours or 1440 minutes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing fitted parameters and statistics:
- ‘MESOR’: Midline Estimating Statistic Of Rhythm (rhythm-adjusted mean)
- ‘amplitude’: Half the peak-to-trough difference
- ‘acrophase’: Time of peak relative to the period in radians
- ‘fitted_values’: Array of fitted values at each time point</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses CosinorPy.cosinor1.fit_cosinor for the core fitting algorithm</p></li>
<li><p>The period is converted to minutes (period * 60) for internal processing</p></li>
<li><p>The function returns both the fitted parameters and the fitted values</p></li>
<li><p>The acrophase is returned in radians and represents the timing of peak activity</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample circadian data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1440</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 24 hours in minutes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">time</span> <span class="o">/</span> <span class="mi">1440</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1440</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit cosinor model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">fit_cosinor</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MESOR: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;MESOR&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Amplitude: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Acrophase: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;acrophase&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> radians&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="non-parametric-circadian-rhythm-analysis-analysis">
<h3>Non-parametric (Circadian Rhythm Analysis) Analysis<a class="headerlink" href="#non-parametric-circadian-rhythm-analysis-analysis" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.nonparam_analysis.IV">
<span class="sig-name descname"><span class="pre">IV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/nonparam_analysis.html#IV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.nonparam_analysis.IV" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the intradaily variability (IV) for the entire dataset.</p>
<p>Intradaily variability quantifies the fragmentation of rest-activity patterns
within each 24-hour period. It is calculated as the ratio of the mean squared
first derivative to the variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.Series</em>) – Time series data containing activity measurements with datetime index
and ‘ENMO’ column. Should contain multiple days of minute-level data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intradaily variability value, where:
- Lower values indicate less fragmented activity patterns
- Higher values indicate more fragmented activity patterns
Returns np.nan if insufficient data or calculation fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Resamples data to hourly resolution for calculation</p></li>
<li><p>IV = (P * sum((z_p - z_{p-1})²)) / ((P-1) * sum((z_p - z_mean)²))</p></li>
<li><p>Lower values indicate more consolidated rest-activity periods</p></li>
<li><p>Higher values indicate more fragmented sleep and activity patterns</p></li>
<li><p>Used in circadian rhythm analysis to assess rhythm fragmentation</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day activity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate fragmented activity pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hours</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">hour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4320</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># Random activity</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate intradaily variability</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv_value</span> <span class="o">=</span> <span class="n">IV</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Intradaily Variability: </span><span class="si">{</span><span class="n">iv_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher values indicate more fragmented activity patterns</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.nonparam_analysis.IS">
<span class="sig-name descname"><span class="pre">IS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/nonparam_analysis.html#IS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.nonparam_analysis.IS" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the interdaily stability (IS) for the entire dataset.</p>
<p>Interdaily stability quantifies the strength of coupling between the
rest-activity rhythm and environmental zeitgebers. It compares the
24-hour pattern across days.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.Series</em>) – Time series data containing activity measurements with datetime index
and ‘ENMO’ column. Should contain multiple days of minute-level data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interdaily stability value ranging from 0 to 1, where:
- 0 indicates no stability (random activity patterns)
- 1 indicates perfect stability (identical daily patterns)
Returns np.nan if insufficient data or calculation fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Resamples data to hourly resolution for calculation</p></li>
<li><p>IS = (D * sum((hourly_means - overall_mean)²)) / sum((all_values - overall_mean)²)</p></li>
<li><p>Higher values indicate more consistent daily activity patterns</p></li>
<li><p>Requires multiple days of data for meaningful calculation</p></li>
<li><p>Used in circadian rhythm analysis to assess rhythm stability</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day activity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate consistent daily pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hours</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">hour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">hours</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">4320</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate interdaily stability</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_value</span> <span class="o">=</span> <span class="n">IS</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interdaily Stability: </span><span class="si">{</span><span class="n">is_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher values indicate more consistent daily patterns</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.nonparam_analysis.RA">
<span class="sig-name descname"><span class="pre">RA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/nonparam_analysis.html#RA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.nonparam_analysis.RA" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the relative amplitude (RA) for each day.</p>
<p>Relative amplitude is calculated as the difference between the most active
10-hour period and least active 5-hour period, divided by their sum.
This provides a normalized measure of the daily activity rhythm strength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m10</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of M10 values (mean activity during 10 most active hours) for each day.
Should be output from the M10() function.</p></li>
<li><p><strong>l5</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of L5 values (mean activity during 5 least active hours) for each day.
Should be output from the L5() function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of relative amplitude values for each day, where:
- Values range from 0 to 1
- Higher values indicate stronger daily activity rhythms
- Lower values indicate weaker daily activity rhythms
Returns empty list if input lists are empty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>RA = (M10 - L5) / (M10 + L5)</p></li>
<li><p>Normalized measure that accounts for overall activity level</p></li>
<li><p>Higher values indicate more pronounced rest-activity cycles</p></li>
<li><p>Used in circadian rhythm analysis to assess rhythm strength</p></li>
<li><p>Requires both M10 and L5 values from the same dataset</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day activity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hours</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">hour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">hours</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">4320</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate M10 and L5 first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m10_values</span><span class="p">,</span> <span class="n">m10_starts</span> <span class="o">=</span> <span class="n">M10</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l5_values</span><span class="p">,</span> <span class="n">l5_starts</span> <span class="o">=</span> <span class="n">L5</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate relative amplitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ra_values</span> <span class="o">=</span> <span class="n">RA</span><span class="p">(</span><span class="n">m10_values</span><span class="p">,</span> <span class="n">l5_values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative Amplitude values: </span><span class="si">{</span><span class="n">ra_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher values indicate stronger daily activity rhythms</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.nonparam_analysis.M10">
<span class="sig-name descname"><span class="pre">M10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/nonparam_analysis.html#M10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.nonparam_analysis.M10" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the M10 (mean activity during the 10 most active hours)
and the start time of the 10 most active hours (M10_start) for each day.</p>
<p>M10 provides information about the most active period during each day,
which typically corresponds to the main activity phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.Series</em>) – Time series data containing activity measurements with datetime index
and ‘ENMO’ column. Should contain minute-level data for multiple days.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing two lists:
- m10: List of mean activity values during the 10 most active hours for each day
- m10_start: List of start times (datetime) of the 10 most active hours for each day
Returns empty lists if insufficient data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses rolling 10-hour windows (600 minutes) to find the most active period</p></li>
<li><p>Calculates mean activity within each window and finds the maximum</p></li>
<li><p>Returns both the activity level and start time of the most active period</p></li>
<li><p>Used in circadian rhythm analysis to identify the main activity phase</p></li>
<li><p>Typically corresponds to daytime activity periods</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day activity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate activity with peak during day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hours</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">hour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">hours</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">4320</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate M10 for each day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m10_values</span><span class="p">,</span> <span class="n">m10_starts</span> <span class="o">=</span> <span class="n">M10</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M10 values: </span><span class="si">{</span><span class="n">m10_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M10 start times: </span><span class="si">{</span><span class="n">m10_starts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.nonparam_analysis.L5">
<span class="sig-name descname"><span class="pre">L5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/nonparam_analysis.html#L5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.nonparam_analysis.L5" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the L5 (mean activity during the 5 least active hours)
and the start time of the 5 least active hours (L5_start) for each day.</p>
<p>L5 provides information about the least active period during each day,
which typically corresponds to the main rest phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.Series</em>) – Time series data containing activity measurements with datetime index
and ‘ENMO’ column. Should contain minute-level data for multiple days.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing two lists:
- l5: List of mean activity values during the 5 least active hours for each day
- l5_start: List of start times (datetime) of the 5 least active hours for each day
Returns empty lists if insufficient data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses rolling 5-hour windows (300 minutes) to find the least active period</p></li>
<li><p>Calculates mean activity within each window and finds the minimum</p></li>
<li><p>Returns both the activity level and start time of the least active period</p></li>
<li><p>Used in circadian rhythm analysis to identify the main rest phase</p></li>
<li><p>Typically corresponds to nighttime sleep periods</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day activity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate activity with low during night</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hours</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">hour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">hours</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">4320</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate L5 for each day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l5_values</span><span class="p">,</span> <span class="n">l5_starts</span> <span class="o">=</span> <span class="n">L5</span><span class="p">(</span><span class="n">enmo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L5 values: </span><span class="si">{</span><span class="n">l5_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L5 start times: </span><span class="si">{</span><span class="n">l5_starts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="physical-activity-metrics">
<h3>Physical Activity Metrics<a class="headerlink" href="#physical-activity-metrics" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.physical_activity_metrics.activity_metrics">
<span class="sig-name descname"><span class="pre">activity_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pa_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'lm':</span> <span class="pre">0.1,</span> <span class="pre">'mv':</span> <span class="pre">0.4,</span> <span class="pre">'sl':</span> <span class="pre">0.03}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/physical_activity_metrics.html#activity_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.physical_activity_metrics.activity_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Sedentary Behavior (SB), Light Physical Activity (LIPA), and
Moderate-to-Vigorous Physical Activity (MVPA) durations in minutes for each day.</p>
<p>This function classifies physical activity levels based on ENMO (Euclidean Norm Minus One)
values using established cutpoints and returns the duration spent in each activity level
for each day in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.Series</em>) – A pandas Series with a DatetimeIndex and ENMO (Euclidean Norm Minus One) values.
The index should be datetime with minute-level resolution.
The values should be float numbers representing acceleration in g units.</p></li>
<li><p><strong>pa_params</strong> (<em>dict</em><em>, </em><em>default=cutpoints</em>) – Dictionary containing physical activity cutpoints:
- ‘sl’ or ‘pa_cutpoint_sl’: Sedentary behavior threshold (default: 0.030g)
- ‘lm’ or ‘pa_cutpoint_lm’: Light activity threshold (default: 0.100g)
- ‘mv’ or ‘pa_cutpoint_mv’: Moderate-to-vigorous activity threshold (default: 0.400g)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing four lists of daily activity durations in minutes:
- sedentary_minutes: Minutes spent in sedentary behavior (ENMO ≤ sl)
- light_minutes: Minutes spent in light physical activity (sl &lt; ENMO ≤ lm)
- moderate_minutes: Minutes spent in moderate physical activity (lm &lt; ENMO ≤ mv)
- vigorous_minutes: Minutes spent in vigorous physical activity (ENMO &gt; mv)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If required cutpoints are not found in the pa_params dictionary.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function assumes minute-level data and returns durations in minutes</p></li>
<li><p>ENMO cutpoints are based on established thresholds for physical activity classification</p></li>
<li><p>Cutpoints may vary depending on accelerometer type, position, and user characteristics</p></li>
<li><p>Returns empty lists if input data is empty</p></li>
<li><p>Groups data by date and calculates daily totals</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample ENMO data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># One day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enmo_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1440</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate activity metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sb</span><span class="p">,</span> <span class="n">lipa</span><span class="p">,</span> <span class="n">mvpa</span><span class="p">,</span> <span class="n">vig</span> <span class="o">=</span> <span class="n">activity_metrics</span><span class="p">(</span><span class="n">enmo_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sedentary minutes: </span><span class="si">{</span><span class="n">sb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Light activity minutes: </span><span class="si">{</span><span class="n">lipa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moderate activity minutes: </span><span class="si">{</span><span class="n">mvpa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vigorous activity minutes: </span><span class="si">{</span><span class="n">vig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use custom cutpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_cutpoints</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;pa_cutpoint_sl&#39;</span><span class="p">:</span> <span class="mf">0.020</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;pa_cutpoint_lm&#39;</span><span class="p">:</span> <span class="mf">0.080</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;pa_cutpoint_mv&#39;</span><span class="p">:</span> <span class="mf">0.300</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sb</span><span class="p">,</span> <span class="n">lipa</span><span class="p">,</span> <span class="n">mvpa</span><span class="p">,</span> <span class="n">vig</span> <span class="o">=</span> <span class="n">activity_metrics</span><span class="p">(</span><span class="n">enmo_data</span><span class="p">,</span> <span class="n">pa_params</span><span class="o">=</span><span class="n">custom_cutpoints</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="sleep-metrics">
<h3>Sleep Metrics<a class="headerlink" href="#sleep-metrics" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.apply_sleep_wake_predictions">
<span class="sig-name descname"><span class="pre">apply_sleep_wake_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#apply_sleep_wake_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.apply_sleep_wake_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Apply sleep-wake prediction to accelerometer data using ENMO values.</p>
<p>This function uses machine learning algorithms to classify each minute as either
sleep or wake based on the activity level (ENMO values). The prediction is based
on the assumption that lower activity levels correspond to sleep periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – Input DataFrame containing ENMO values in a column named ‘ENMO’.
Should have a datetime index with minute-level resolution.</p></li>
<li><p><strong>sleep_params</strong> (<em>dict</em>) – Dictionary containing sleep prediction parameters:
- ‘sleep_ck_sf’: Sampling frequency for sleep classification (default: 0.0025)
- ‘sleep_rescore’: Whether to rescore sleep predictions (default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Series containing sleep predictions with the same index as input data:
- 1 = sleep
- 0 = wake</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If ‘ENMO’ column is not found in DataFrame.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses skdh.sleep.sleep_classification.compute_sleep_predictions for the core algorithm</p></li>
<li><p>The function adds a ‘sleep’ column to the input DataFrame</p></li>
<li><p>Sleep predictions are based on activity patterns and circadian rhythms</p></li>
<li><p>The algorithm is trained on large datasets of polysomnography-validated sleep</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample ENMO data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># One day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;ENMO&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1440</span><span class="p">)</span>  <span class="c1"># Random activity levels</span>
<span class="gp">... </span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">timestamps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply sleep-wake predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sleep_ck_sf&#39;</span><span class="p">:</span> <span class="mf">0.0025</span><span class="p">,</span> <span class="s1">&#39;sleep_rescore&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_predictions</span> <span class="o">=</span> <span class="n">apply_sleep_wake_predictions</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sleep_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sleep time: </span><span class="si">{</span><span class="n">sleep_predictions</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2"> minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.WASO">
<span class="sig-name descname"><span class="pre">WASO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#WASO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.WASO" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Wake After Sleep Onset (WASO) for each 24-hour cycle.</p>
<p>WASO represents the total time spent awake after the first sleep onset
until the final wake time. It’s a key metric for sleep quality assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (0=sleep, 1=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing WASO values in minutes for each 24-hour cycle.
Returns 0 for days where no sleep is detected.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Processes data in 24-hour cycles starting at midnight</p></li>
<li><p>Uses the WakeAfterSleepOnset class from sleep_metrics library</p></li>
<li><p>Higher WASO values indicate more fragmented sleep</p></li>
<li><p>Important metric for assessing sleep maintenance</p></li>
<li><p>Zero is returned for days where no sleep is detected</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample sleep data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate sleep pattern with some wake periods</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">480</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">810</span>  <span class="c1"># Sleep with wake periods</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_pattern</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate WASO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">waso_values</span> <span class="o">=</span> <span class="n">WASO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wake After Sleep Onset: </span><span class="si">{</span><span class="n">waso_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.TST">
<span class="sig-name descname"><span class="pre">TST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#TST"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.TST" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Total Sleep Time (TST) for each 24-hour cycle.</p>
<p>TST represents the total time spent in sleep state during the analysis period.
It’s a fundamental metric for sleep quantity assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (1=sleep, 0=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing total sleep time in minutes for each 24-hour cycle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Processes data in 24-hour cycles starting at midnight</p></li>
<li><p>Uses the TotalSleepTime class from sleep_metrics library</p></li>
<li><p>Sleep time is calculated by counting all epochs marked as sleep (1)</p></li>
<li><p>Key metric for assessing sleep quantity</p></li>
<li><p>Recommended TST varies by age group (7-9 hours for adults)</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample sleep data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate 8 hours of sleep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">480</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">960</span>  <span class="c1"># 8 hours sleep, 16 hours wake</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_pattern</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate TST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tst_values</span> <span class="o">=</span> <span class="n">TST</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Sleep Time: </span><span class="si">{</span><span class="n">tst_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> minutes (</span><span class="si">{</span><span class="n">tst_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> hours)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.PTA">
<span class="sig-name descname"><span class="pre">PTA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#PTA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.PTA" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Percent Time Asleep (PTA) for each 24-hour cycle.</p>
<p>PTA represents the percentage of time spent asleep relative to the total recording time.
It provides a normalized measure of sleep quantity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (1=sleep, 0=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing percent time asleep (0-1) for each 24-hour cycle.
Values range from 0 (no sleep) to 1 (100% sleep).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Processes data in 24-hour cycles starting at midnight</p></li>
<li><p>Uses the PercentTimeAsleep class from sleep_metrics library</p></li>
<li><p>PTA = (number of sleep epochs) / (total number of epochs)</p></li>
<li><p>Useful for comparing sleep patterns across different recording durations</p></li>
<li><p>Typical PTA values range from 0.25 to 0.40 (25-40% of day)</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample sleep data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate 8 hours of sleep (33.3% of day)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">480</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">960</span>  <span class="c1"># 8 hours sleep, 16 hours wake</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_pattern</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate PTA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pta_values</span> <span class="o">=</span> <span class="n">PTA</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percent Time Asleep: </span><span class="si">{</span><span class="n">pta_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pta_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.NWB">
<span class="sig-name descname"><span class="pre">NWB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#NWB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.NWB" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Number of Wake Bouts (NWB) for each 24-hour cycle.</p>
<p>NWB represents the count of distinct wake episodes occurring between sleep periods
during the analysis period. It’s a measure of sleep fragmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (1=sleep, 0=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the number of wake bouts for each 24-hour cycle.
Higher values indicate more fragmented sleep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Processes data in 24-hour cycles starting at midnight</p></li>
<li><p>Uses the NumberWakeBouts class from sleep_metrics library</p></li>
<li><p>A wake bout is defined as a continuous period of wake states between sleep states</p></li>
<li><p>Higher NWB values indicate more fragmented sleep patterns</p></li>
<li><p>Important metric for assessing sleep quality and continuity</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample sleep data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate fragmented sleep with multiple wake bouts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">240</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">120</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">120</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">910</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_pattern</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate NWB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nwb_values</span> <span class="o">=</span> <span class="n">NWB</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Wake Bouts: </span><span class="si">{</span><span class="n">nwb_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.SOL">
<span class="sig-name descname"><span class="pre">SOL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#SOL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.SOL" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Sleep Onset Latency (SOL) for each 24-hour cycle.</p>
<p>SOL represents the time taken to fall asleep, measured from the start of the
recording period until the first sleep onset. It’s a key metric for sleep initiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (1=sleep, 0=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing sleep onset latency in minutes for each 24-hour cycle.
Lower values indicate faster sleep onset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Processes data in 24-hour cycles starting at midnight</p></li>
<li><p>Uses the SleepOnsetLatency class from sleep_metrics library</p></li>
<li><p>SOL is calculated as the time from the start of the recording until the first detected sleep episode</p></li>
<li><p>Lower SOL values indicate better sleep initiation</p></li>
<li><p>Typical SOL values range from 10-30 minutes for healthy sleepers</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample sleep data for one day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate 30 minutes to fall asleep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1410</span>  <span class="c1"># 30 min wake, then sleep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_pattern</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate SOL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol_values</span> <span class="o">=</span> <span class="n">SOL</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sleep Onset Latency: </span><span class="si">{</span><span class="n">sol_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.sleep_metrics.SRI">
<span class="sig-name descname"><span class="pre">SRI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/sleep_metrics.html#SRI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.sleep_metrics.SRI" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Sleep Regularity Index (SRI) for the entire dataset.</p>
<p>SRI quantifies the day-to-day similarity of sleep-wake patterns. It ranges from -100
(completely irregular) to +100 (perfectly regular).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame with:
- datetime index
- ‘sleep’ column (1=sleep, 0=wake)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sleep Regularity Index value ranging from -100 to +100:
- -100: Completely irregular sleep patterns
- 0: Random sleep patterns
- +100: Perfectly regular sleep patterns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Requires multiple days of data for meaningful calculation</p></li>
<li><p>Compares sleep-wake patterns across consecutive days</p></li>
<li><p>Higher SRI values indicate more consistent sleep schedules</p></li>
<li><p>Important metric for assessing sleep hygiene and circadian rhythm stability</p></li>
<li><p>Uses overlapping day pairs to calculate similarity</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample multi-day sleep data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4320</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>  <span class="c1"># 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate consistent sleep pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">480</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">960</span>  <span class="c1"># 8 hours sleep, 16 hours wake</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_data</span> <span class="o">=</span> <span class="n">sleep_pattern</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># Repeat for 3 days</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sleep&#39;</span><span class="p">:</span> <span class="n">sleep_data</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate SRI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sri_value</span> <span class="o">=</span> <span class="n">SRI</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sleep Regularity Index: </span><span class="si">{</span><span class="n">sri_value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher values indicate more regular sleep patterns</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rescaling-functions">
<h3>Rescaling Functions<a class="headerlink" href="#rescaling-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.rescaling.min_max_scaling_exclude_outliers">
<span class="sig-name descname"><span class="pre">min_max_scaling_exclude_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_quantile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/rescaling.html#min_max_scaling_exclude_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.rescaling.min_max_scaling_exclude_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Scales the data using min-max scaling to a [0,100] range, excluding outliers based on quantiles.</p>
<p>This function applies min-max scaling to normalize data to a [0,100] range while
using robust bounds that exclude extreme outliers. Values above the upper quantile
threshold are not excluded from the final result but may exceed 100.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – Input data to be scaled. Can be either a pandas Series or numpy array of numeric values.</p></li>
<li><p><strong>upper_quantile</strong> (<em>float</em><em>, </em><em>default=0.999</em>) – Upper quantile threshold for excluding outliers when calculating min/max bounds.
Defaults to 0.999 (99.9th percentile).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scaled data with values generally ranging from 0 to 100. Note:
- If input contains all identical values, returns zeros
- Values above the upper_quantile may exceed 100 in the output
- Output maintains the same length as input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input data is empty.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses quantile-based outlier detection for robust scaling</p></li>
<li><p>Applies min-max scaling: (x - min) / (max - min) * 100</p></li>
<li><p>Handles edge cases like constant data and zero division</p></li>
<li><p>Preserves outliers in output but uses robust bounds for scaling</p></li>
<li><p>Useful for normalizing accelerometer data while handling extreme values</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with normal data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled</span> <span class="o">=</span> <span class="n">min_max_scaling_exclude_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaled</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Output: [0.0, 25.0, 50.0, 75.0, 100.0]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with outliers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_with_outliers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled</span> <span class="o">=</span> <span class="n">min_max_scaling_exclude_outliers</span><span class="p">(</span><span class="n">data_with_outliers</span><span class="p">,</span> <span class="n">upper_quantile</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaled</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Output: [0.0, 50.0, 100.0, 4950.0] (outlier exceeds 100)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with constant data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constant_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled</span> <span class="o">=</span> <span class="n">min_max_scaling_exclude_outliers</span><span class="p">(</span><span class="n">constant_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaled</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Output: [0.0, 0.0, 0.0, 0.0]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="visualization-functions">
<h3>Visualization Functions<a class="headerlink" href="#visualization-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.visualization.plot_sleep_predictions">
<span class="sig-name descname"><span class="pre">plot_sleep_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/visualization.html#plot_sleep_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.visualization.plot_sleep_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Plot sleep predictions over time.</p>
<p>Creates visualization of sleep/wake predictions, optionally including non-wear periods.
Simple mode shows a binary plot with dots, while detailed mode shows ENMO data
with colored bands for sleep/wake states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_obj</strong> (<a class="reference internal" href="#cosinorage.features.features.WearableFeatures" title="cosinorage.features.features.WearableFeatures"><em>WearableFeatures</em></a>) – Feature object containing ml_data with sleep predictions. Must have:
- ml_data: DataFrame with ‘sleep’ column (1=sleep, 0=wake)
- Optional ‘wear’ column for non-wear periods
- ‘ENMO’ column for detailed plotting</p></li>
<li><p><strong>simple</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, shows simple binary plot with dots for sleep/wake states.
If False, shows detailed plot with ENMO data and colored bands.</p></li>
<li><p><strong>start_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – Start date for plotting. If None, uses the earliest date in the data.</p></li>
<li><p><strong>end_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – End date for plotting. If None, uses the latest date in the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Simple mode: Shows binary sleep/wake states as colored dots</p></li>
<li><p>Detailed mode: Shows ENMO activity data with colored bands for sleep/wake</p></li>
<li><p>Non-wear periods are shown in red if ‘wear’ column is available</p></li>
<li><p>The function automatically handles date range selection</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">WearableFeatures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.datahandlers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericDataHandler</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data and compute features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">GenericDataHandler</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">WearableFeatures</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot sleep predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_sleep_predictions</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_sleep_predictions</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2023-01-02&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.visualization.plot_non_wear">
<span class="sig-name descname"><span class="pre">plot_non_wear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/visualization.html#plot_non_wear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.visualization.plot_non_wear" title="Link to this definition">¶</a></dt>
<dd><p>Plot non-wear periods over time.</p>
<p>Creates visualization of wear/non-wear periods. Simple mode shows a binary plot
with dots, while detailed mode shows ENMO data with colored bands for wear states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_obj</strong> (<a class="reference internal" href="#cosinorage.features.features.WearableFeatures" title="cosinorage.features.features.WearableFeatures"><em>WearableFeatures</em></a>) – Feature object containing ml_data with wear/non-wear predictions. Must have:
- ml_data: DataFrame with ‘wear’ column (1=worn, 0=not worn)
- ‘ENMO’ column for detailed plotting</p></li>
<li><p><strong>simple</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, shows simple binary plot with dots for wear/non-wear states.
If False, shows detailed plot with ENMO data and colored bands.</p></li>
<li><p><strong>start_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – Start date for plotting. If None, uses the earliest date in the data.</p></li>
<li><p><strong>end_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – End date for plotting. If None, uses the latest date in the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Simple mode: Shows binary wear/non-wear states as colored dots</p></li>
<li><p>Detailed mode: Shows ENMO activity data with colored bands for wear states</p></li>
<li><p>Non-wear periods are highlighted in red, wear periods in green</p></li>
<li><p>The function automatically handles date range selection</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">WearableFeatures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.datahandlers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericDataHandler</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data and compute features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">GenericDataHandler</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">WearableFeatures</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot wear/non-wear periods</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_non_wear</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_non_wear</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2023-01-02&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.visualization.plot_cosinor">
<span class="sig-name descname"><span class="pre">plot_cosinor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/visualization.html#plot_cosinor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.visualization.plot_cosinor" title="Link to this definition">¶</a></dt>
<dd><p>Plot cosinor analysis results for activity rhythm analysis.</p>
<p>Creates detailed visualizations of circadian rhythm analysis showing raw activity data (ENMO)
overlaid with fitted cosinor curves. Includes markers for key circadian parameters:
MESOR (rhythm-adjusted mean), amplitude, and acrophase (peak timing).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feature_obj</strong> (<a class="reference internal" href="#cosinorage.features.features.WearableFeatures" title="cosinorage.features.features.WearableFeatures"><em>WearableFeatures</em></a>) – Feature object containing cosinor analysis results and ENMO data.
The ml_data DataFrame must contain ‘ENMO’ and ‘cosinor_fitted’ columns.
The feature_dict must contain a ‘cosinor’ key with mesor, amplitude,
acrophase, and acrophase_time values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot using matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If cosinor features haven’t been computed (missing ‘cosinor_fitted’ column).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Shows raw ENMO data in red and fitted cosinor curve in blue</p></li>
<li><p>MESOR is displayed as a horizontal green dashed line</p></li>
<li><p>The plot provides visual validation of the cosinor fit quality</p></li>
<li><p>Y-axis limits are automatically adjusted to show the full range of data</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">WearableFeatures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.datahandlers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericDataHandler</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data and compute features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">GenericDataHandler</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">WearableFeatures</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot cosinor analysis results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_cosinor</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="dashboard-functions">
<h3>Dashboard Functions<a class="headerlink" href="#dashboard-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="cosinorage.features.utils.dashboard.dashboard">
<span class="sig-name descname"><span class="pre">dashboard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosinorage/features/utils/dashboard.html#dashboard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosinorage.features.utils.dashboard.dashboard" title="Link to this definition">¶</a></dt>
<dd><p>Generate a comprehensive visualization dashboard for accelerometer data analysis.</p>
<p>This function creates multiple plots to visualize various aspects of the accelerometer data:
1. Cosinor fit plot showing ENMO data with mesor, amplitude, and acrophase
2. Daily ENMO plots with M10 and L5 periods highlighted
3. IS (Inter-daily Stability) and IV (Intra-daily Variability) visualization
4. RA (Relative Amplitude) plots for each day
5. Sleep predictions visualization
6. Sleep metrics (TST, WASO, PTA, NWB, SOL) visualization
7. Physical activity breakdown by intensity levels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>features</strong> (<a class="reference internal" href="#cosinorage.features.features.WearableFeatures" title="cosinorage.features.features.WearableFeatures"><em>WearableFeatures</em></a>) – A WearableFeatures object containing all extracted features and raw data.
Expected to have the following attributes:
- feature_dict: Dictionary containing cosinor, nonparam, sleep, and physical_activity features
- get_ml_data(): Method returning DataFrame with ENMO and cosinor_fitted data
- get_features(): Method returning all extracted features</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays multiple matplotlib figures using plt.show()</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Creates 7 different visualization panels covering all major analysis aspects</p></li>
<li><p>Each panel is optimized for the specific metrics being displayed</p></li>
<li><p>The dashboard provides a comprehensive overview of circadian rhythm analysis</p></li>
<li><p>All plots use consistent color schemes and formatting</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">WearableFeatures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cosinorage.datahandlers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericDataHandler</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data and compute features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">GenericDataHandler</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">WearableFeatures</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate comprehensive dashboard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cosinorage.bioages.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">cosinorage.bioages Module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="cosinorage.datahandlers.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">cosinorage.datahandlers Module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Jacob Leo Oskar Hunecke
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">cosinorage.features Module</a><ul>
<li><a class="reference internal" href="#module-cosinorage.features">Module Contents</a></li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures"><code class="docutils literal notranslate"><span class="pre">WearableFeatures</span></code></a><ul>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures.enmo"><code class="docutils literal notranslate"><span class="pre">WearableFeatures.enmo</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures.feature_dict"><code class="docutils literal notranslate"><span class="pre">WearableFeatures.feature_dict</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures.__init__"><code class="docutils literal notranslate"><span class="pre">WearableFeatures.__init__()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures.get_features"><code class="docutils literal notranslate"><span class="pre">WearableFeatures.get_features()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.features.WearableFeatures.get_ml_data"><code class="docutils literal notranslate"><span class="pre">WearableFeatures.get_ml_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#utility-functions">Utility Functions</a><ul>
<li><a class="reference internal" href="#cosinor-circadian-rhythm-analysis-analysis">Cosinor (Circadian Rhythm Analysis) Analysis</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.cosinor_analysis.cosinor_multiday"><code class="docutils literal notranslate"><span class="pre">cosinor_multiday()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.cosinor_analysis.cosinor_model"><code class="docutils literal notranslate"><span class="pre">cosinor_model()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.cosinor_analysis.fit_cosinor"><code class="docutils literal notranslate"><span class="pre">fit_cosinor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#non-parametric-circadian-rhythm-analysis-analysis">Non-parametric (Circadian Rhythm Analysis) Analysis</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.nonparam_analysis.IV"><code class="docutils literal notranslate"><span class="pre">IV()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.nonparam_analysis.IS"><code class="docutils literal notranslate"><span class="pre">IS()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.nonparam_analysis.RA"><code class="docutils literal notranslate"><span class="pre">RA()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.nonparam_analysis.M10"><code class="docutils literal notranslate"><span class="pre">M10()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.nonparam_analysis.L5"><code class="docutils literal notranslate"><span class="pre">L5()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-activity-metrics">Physical Activity Metrics</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.physical_activity_metrics.activity_metrics"><code class="docutils literal notranslate"><span class="pre">activity_metrics()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sleep-metrics">Sleep Metrics</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.apply_sleep_wake_predictions"><code class="docutils literal notranslate"><span class="pre">apply_sleep_wake_predictions()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.WASO"><code class="docutils literal notranslate"><span class="pre">WASO()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.TST"><code class="docutils literal notranslate"><span class="pre">TST()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.PTA"><code class="docutils literal notranslate"><span class="pre">PTA()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.NWB"><code class="docutils literal notranslate"><span class="pre">NWB()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.SOL"><code class="docutils literal notranslate"><span class="pre">SOL()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.sleep_metrics.SRI"><code class="docutils literal notranslate"><span class="pre">SRI()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rescaling-functions">Rescaling Functions</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.rescaling.min_max_scaling_exclude_outliers"><code class="docutils literal notranslate"><span class="pre">min_max_scaling_exclude_outliers()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualization-functions">Visualization Functions</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.visualization.plot_sleep_predictions"><code class="docutils literal notranslate"><span class="pre">plot_sleep_predictions()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.visualization.plot_non_wear"><code class="docutils literal notranslate"><span class="pre">plot_non_wear()</span></code></a></li>
<li><a class="reference internal" href="#cosinorage.features.utils.visualization.plot_cosinor"><code class="docutils literal notranslate"><span class="pre">plot_cosinor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dashboard-functions">Dashboard Functions</a><ul>
<li><a class="reference internal" href="#cosinorage.features.utils.dashboard.dashboard"><code class="docutils literal notranslate"><span class="pre">dashboard()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>